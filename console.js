var url=location.origin+"/",doc_id=709659;function gs(){return document.getElementsByClassName("activity-wrapper")[0].innerHTML.match(/(?<=ng-init="init\()(.*?)(?=\)")/g)[0].match(/(?<=,)\d*(?=,)/g)[0]}async function gq(a){return await fetch(`${url}api2/test/sessions/${a}`).then(a=>a.json()).then(a=>[a.questions.map(a=>[a.id,a.options,a.point,a.type]),a.settings.show_answer])}async function gc(a,b){return await fetch(`${url}api/test/questions/clone`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:a,document_id:doc_id})}).then(a=>a.json()).then(a=>(fetch(`${url}api/test/questions/${a.id}`,{method:"DELETE"}),a.options.filter(a=>"1"==a.correct).map(c=>b.filter(b=>b.value==c.value&&b.image==c.image)[0]).map(a=>a.id)))}async function af(a,b,c,d){return await fetch(`${url}api2/test/responses/answer`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_id:a,answer:c,question_id:b[0],show_answer:d,type:b[3],point:b[2],homeworkType:!1,homework:!1})}).then(a=>a.json())}Array.prototype.random=function(){return this[Math.floor(Math.random()*this.length)]};async function doTheTest(timing=0,wrong=0,time_offset=0,show_progress=!0,change_cookie=!0,session=gs()){change_cookie&&(document.cookie="PHPSESSID=q15j2chvo6r5du6svuvmuf2459;path=/"),gq(session).then(e=>{Promise.all(e[0].sort(()=>Math.random()-.5).map((g,h)=>new Promise(i=>setTimeout(async()=>{await af(session,g,await gc(g[0],g[1]).then(c=>h<wrong?[g[1].map(a=>a.id).filter(a=>!c.includes(a)).random()]:c),e[1]),show_progress&&console.log(`âœ¨ ${h} / ${e.length}`),i()},h*timing+2*(Math.random()*time_offset)-time_offset)))).then(()=>{console.log("ðŸŽ‰ðŸŽ‰ðŸŽ‰"),fetch(`${url}api2/test/sessions/end/${session}`,{method:"PUT"}).then(()=>setTimeout(location.reload(),3e3))})})}doTheTest